

# âœ… C2Cæ±ºæ¸ˆæ§‹ç¯‰ ToDoãƒªã‚¹ãƒˆï¼ˆSupabase + Go + Stripe Customï¼‰

## ğŸ—ï¸ ç’°å¢ƒæº–å‚™

* [ ] Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆèªè¨¼ãƒ»DBã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼‰
* [ ] Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆé–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ONï¼‰
* [ ] Go ã®é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ï¼ˆ`go1.22+` æ¨å¥¨ï¼‰
* [ ] `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¨­å®š

  * [ ] `STRIPE_SECRET_KEY`
  * [ ] `STRIPE_WEBHOOK_SECRET`
  * [ ] `SUPABASE_URL`
  * [ ] `SUPABASE_SERVICE_ROLE_KEY`

---

## ğŸ§± Supabase å´

* [ ] `profiles` ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼Stripeã‚¢ã‚«ã‚¦ãƒ³ãƒˆç´ä»˜ã‘ç”¨ï¼‰
* [ ] `transactions` ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆå–å¼•è¨˜éŒ²ï¼‰
* [ ] RLSï¼ˆRow Level Securityï¼‰æœ‰åŠ¹åŒ–
* [ ] RLSãƒãƒªã‚·ãƒ¼è¨­å®š

  * [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã®ã¿ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é–²è¦§å¯
  * [ ] å½“äº‹è€…ã®ã¿å–å¼•ãƒ‡ãƒ¼ã‚¿é–²è¦§å¯
* [ ] Service Roleã‚­ãƒ¼ã®å–å¾—ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ï¼‰

---

## ğŸ’³ Stripe å´è¨­å®š

* [ ] Connect â†’ Customã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æœ‰åŠ¹åŒ–
* [ ] ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è¨­å®šï¼ˆå›½ï¼šJPï¼‰
* [ ] Connectã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆAPIã‚’ç¢ºèªï¼ˆ`POST /v1/accounts`ï¼‰
* [ ] Webhookã‚’ä½œæˆã—ã€ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡å…ˆã‚’ `/stripe/webhook` ã«è¨­å®š
* [ ] å¿…è¦ãªã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²

  * [ ] `payment_intent.succeeded`
  * [ ] `account.updated`
  * [ ] `payout.paid`

---

## ğŸ¹ Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

* [ ] `backend/main.go`
* [ ] `backend/handlers/stripe_create_account.go`
* [ ] `backend/handlers/stripe_payment.go`
* [ ] `backend/handlers/stripe_webhook.go`
* [ ] `backend/supabase/client.go`

### å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

* [ ] `go mod init` / `go get github.com/stripe/stripe-go/v76`
* [ ] `go get github.com/supabase-community/postgrest-go`
* [ ] Stripeã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

  * [ ] `POST /stripe/account` â†’ å£²ã‚Šæ‰‹ã®Customã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
* [ ] æ”¯æ‰•ã„Intentä½œæˆ

  * [ ] `POST /stripe/payment` â†’ è²·ã„æ‰‹â†’å£²ã‚Šæ‰‹é€é‡‘
* [ ] Webhookå—ä¿¡

  * [ ] `POST /stripe/webhook` â†’ æ”¯æ‰•ã„æˆåŠŸé€šçŸ¥ãƒ»Supabaseæ›´æ–°
* [ ] Supabaseé€£æºå‡¦ç†ï¼ˆstatusæ›´æ–°ï¼‰

---

## ğŸ§© ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆNext.jsãªã©ï¼‰

* [ ] å£²ã‚Šæ‰‹ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆStripeã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆAPIå‘¼ã³å‡ºã—ï¼‰
* [ ] è²·ã„æ‰‹ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 
* [ ] å•†å“è³¼å…¥ç”»é¢ â†’ æ”¯æ‰•ã„Intentå‘¼ã³å‡ºã—
* [ ] å£²ã‚Šæ‰‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæ®‹é«˜ãƒ»å…¥é‡‘ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼‰
* [ ] Stripeã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«åŸºã¥ãå…¥é‡‘å¯å¦åˆ¶å¾¡

---

## ğŸ”„ Webhookãƒ†ã‚¹ãƒˆ

* [ ] `stripe listen --forward-to localhost:8080/stripe/webhook`
* [ ] ãƒ†ã‚¹ãƒˆæ”¯æ‰•ã„ã§ `payment_intent.succeeded` ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡
* [ ] Supabaseã® `transactions` ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°ç¢ºèª

---

## ğŸ§ª å‹•ä½œæ¤œè¨¼

* [ ] å£²ã‚Šæ‰‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ² â†’ Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«åæ˜ ã•ã‚Œã‚‹ã‹
* [ ] è²·ã„æ‰‹æ±ºæ¸ˆ â†’ Stripeå´ã§æ”¯æ‰•ã„æˆåŠŸ
* [ ] Webhookã§DBæ›´æ–° â†’ `status = 'paid'`
* [ ] å£²ã‚Šæ‰‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å…¥é‡‘åæ˜ ç¢ºèª

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ / é‹ç”¨

* [ ] `.env`ã‚’æœ¬ç•ªç”¨ã‚­ãƒ¼ã«åˆ‡ã‚Šæ›¿ãˆï¼ˆ`sk_live_`ï¼‰
* [ ] Webhook URLã‚’æœ¬ç•ªç’°å¢ƒURLã«å¤‰æ›´
* [ ] Supabaseä¸Šã®RLSãƒãƒªã‚·ãƒ¼ç¢ºèªï¼ˆæ¼ã‚Œãªã„ã‚ˆã†ã«ï¼‰
* [ ] Stripeæ‰‹æ•°æ–™ãƒ»æŒ¯è¾¼ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š
* [ ] ãƒ­ã‚°ãƒ»ç›£è¦–ï¼ˆCloudWatch or Supabase Logsï¼‰

---
